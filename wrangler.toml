name = "ecommerce-backend"
main = "backend/src/index.ts"
compatibility_date = "2023-10-30"

account_id = "55b0027975cda6f67a48ea231d2cef8d"

# üåê Rotas do Worker (API backend)
routes = [
  "leiasabores.pt/api/*",
  "api.leiasabores.pt/*"
]

# -----------------------------
# ‚úÖ Banco de dados D1
# -----------------------------
[[d1_databases]]
binding = "DB"
database_name = "ecommerce_db"
database_id = "881f400b-6acd-4f0d-abe9-b9e6fe085349"

# -----------------------------
# ‚úÖ R2 Storage
# -----------------------------
[[r2_buckets]]
binding = "R2"
bucket_name = "leiasabores-r2"

# -----------------------------
# ‚úÖ Vari√°veis locais
# -----------------------------
[vars]
ENVIRONMENT = "development"
ALLOWED_ORIGINS = "https://leiasabores.pt, https://www.leiasabores.pt, https://leiasabores.pages.dev, http://localhost:5173"
ADMIN_SEED_TOKEN = "seed-topos-20251105"

# Secrets (will be injected by GitHub Actions or set via `wrangler secret put`)
# Note: In local development, these are read from .env file

# -----------------------------
# ‚úÖ Ambiente de produ√ß√£o
# -----------------------------
[env.production]
name = "partyland-backend"
account_id = "55b0027975cda6f67a48ea231d2cef8d"

[[env.production.d1_databases]]
binding = "DB"
database_id = "881f400b-6acd-4f0d-abe9-b9e6fe085349"

[[env.production.r2_buckets]]
binding = "R2"
bucket_name = "leiasabores-r2"

[env.production.vars]
ENVIRONMENT = "production"
ALLOWED_ORIGINS = "https://leiasabores.pt, https://www.leiasabores.pt, https://leiasabores.pages.dev"
ADMIN_SEED_TOKEN = "seed-topos-20251105"

# Production secrets (will be injected by GitHub Actions)

# -----------------------------
# ‚úÖ Cloudflare Pages (FRONTEND)
# -----------------------------
# Local onde o Vite exporta o build final
pages_build_output_dir = "dist/public"

# Comando para gerar build (usado no Pages)
build_command = "npm run build:frontend"